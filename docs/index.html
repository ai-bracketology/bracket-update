<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Daily CBB Bracket Update</title>

    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
        margin: 0;
      }

      header {
        padding: 16px 20px;
        border-bottom: 1px solid #e6e6e6;
      }

      h1 {
        margin: 0 0 6px 0;
        font-size: 20px;
      }

      .sub {
        color: #555;
        font-size: 14px;
      }

      .updated {
        font-size: 13px;
        color: #777;
        margin-top: 4px;
      }

      .tabs {
        display: flex;
        gap: 8px;
        padding: 10px 20px;
        border-bottom: 1px solid #e6e6e6;
        background: #fafafa;
      }

      .tabbtn {
        border: 1px solid #ddd;
        background: white;
        padding: 8px 14px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 14px;
      }

      .tabbtn.active {
        border-color: #bbb;
        font-weight: 600;
        background: #fff;
      }

      main {
        padding: 0;
      }

      iframe {
        width: 100%;
        height: 92vh;
        border: 0;
      }
    </style>
  </head>

  <body>
    <header>
      <h1>Daily CBB Bracket Update</h1>
      <div class="sub">Auto-updated daily from Google Sheets (SLCT / SLCT+).</div>
      <div id="lastUpdated" class="updated">Last updated: â€”</div>
    </header>

    <main>
      <div class="tabs">
        <button class="tabbtn active" data-tab="field">Bracket</button>
        <button class="tabbtn" data-tab="bubble">Bubble</button>
      </div>

      <iframe
        id="sheetFrame"
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTVdxNvZH6vyW7Q0CwXAdMqxVh62VMhY4kf_-8ZdACwYCXdaH57VvILurCbYUXnE3KGm1jjUU183mHY/pubhtml?gid=838112981&single=true"
        loading="lazy"
      ></iframe>
    </main>

    <script>
      const frame = document.getElementById("sheetFrame");
      const updatedEl = document.getElementById("lastUpdated");

      const TAB_URLS = {
        field:
          "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVdxNvZH6vyW7Q0CwXAdMqxVh62VMhY4kf_-8ZdACwYCXdaH57VvILurCbYUXnE3KGm1jjUU183mHY/pubhtml?gid=838112981&single=true",
        bubble:
          "https://docs.google.com/spreadsheets/d/e/2PACX-1vTVdxNvZH6vyW7Q0CwXAdMqxVh62VMhY4kf_-8ZdACwYCXdaH57VvILurCbYUXnE3KGm1jjUU183mHY/pubhtml?gid=946415823&single=true"
      };

      let currentTab = "field";

      function refreshSheet() {
        const now = new Date();
        const base = TAB_URLS[currentTab].split("&cb=")[0];
        frame.src = base + "&cb=" + now.getTime();

        // Format time in ET
        const et = new Date(
          now.toLocaleString("en-US", { timeZone: "America/New_York" })
        );

        const timeStr = et.toLocaleString("en-US", {
          hour: "numeric",
          minute: "2-digit",
          timeZoneName: "short"
        });

        updatedEl.textContent = `Last updated: ${timeStr}`;
      }

      // Handle tab switching
      document.querySelectorAll(".tabbtn").forEach(btn => {
        btn.addEventListener("click", () => {
          document.querySelectorAll(".tabbtn").forEach(b =>
            b.classList.remove("active")
          );
          btn.classList.add("active");
          currentTab = btn.dataset.tab;
          refreshSheet();
        });
      });

      // Initial load + periodic refresh
      refreshSheet();
      setInterval(refreshSheet, 60000);
    </script>
  </body>
</html>
